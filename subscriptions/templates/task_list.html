<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>Bronze</title>

    <script src="https://unpkg.com/htmx.org@2.0.2" integrity="sha384-Y7hw+L/jvKeWIRRkqWYfPcvVxHzVzn5REgzbawhxAuQGwX1XWe70vji+VSeHOThJ" crossorigin="anonymous"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/main.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


    <script src="/static/js/main.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>

    <header>
        <img
          src="/static/images/logo-for-todolist-website-with-name--taskmaster--c__1_-removebg-preview.png"
          alt="logo"
          class="fade-in logo"
        />
        <nav>
          <ul>
            <li><a href="#">Home</a></li>
            <li><a href="/buy_subscription">Subscriptions</a></li>
            <li><a href="/profile">Profile</a></li>
            {% if status == 'gold'%}
            <li><a href="/statistic">Statistic</a></li>
            {% endif%}


          </ul>
          <div class="rubies-container">
            <img src="/static/images/icons8-jewel-48.png" alt="Ruby" class="ruby-icon">
            <span id="rubies-count" hx-target="#rubies-count" hx-swap="outerHTML">{{ rubies }}</span>
        </div>


        </nav>
      </header>
      <div class="container">
        <aside>
          <button id="openModal" class="side-button first-btn"><img src="/static/images/addition_3032276.png" class="today-icon"> Create task</button>

          <button class="side-button">
            <img src="/static/images/calendar_3558945.png" class="today-icon">
            Today
          </button>
            {% if status != 'bronze'%}
            <button id="category-button"> <img src="/static/images/categories.png" class="today-icon"> Select category</button>
            {% endif%}
    <div id="category-list" class="hidden">
        <a href="/leisure_category" class="category" data-category="home">Leisure</a>
        <a href="/sport_category" class="category" data-category="sport">Sport</a>
        <a href="/learning_category" class="category" data-category="learning">Learning</a>
        <a href="/work_category" class="category" data-category="travel">Work</a>
        <a href="/other_category" class="category" data-category="work">Other</a>
    </div>
        </aside>
        <main class="containers">
          <h1 class="my-4">Task List</h1>
          <div class="black_line"></div>
          <ul id="taskList">
            {% for task in tasks %}
            <li class="task_form" data-id="{{ task.id }}">
                <p class="task-text">{{ task.task }}</p>
                <div class="mt-3">
                  <button hx-post="/update/{{ task.id }}/"
                  hx-confirm="Do you want to complete the task?"
                  hx-target="#taskList"
                  hx-swap="outerHTML"
                  hx-on="htmx:afterRequest: htmx.process(document.body)"
                  hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                  class="btn btn-success me-2">Completed</button>

                  <button hx-post="/delete/{{ task.id }}/"
                  hx-target="#taskList"
                  hx-swap="outerHTML"
                  hx-confirm="Do you want to delete the task?"
                  hx-on="htmx:afterRequest: htmx.process(document.body)"
                  hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                  class="btn btn-danger">Delete</button>

                </div>
                 <span class="category-label category-{{ task.category }}">
                {{ task.category }}
                </span>
                <h2 class="status">Status :
                    <span class="{{ task.status|yesno:'done,progress' }}">
                        {{ task.status|yesno:'Completed,In progress..' }}
                    </span>
                </h2>
            </li>
            {% endfor %}
          </ul>



      </main>

        <div id="taskModal">
          <div id="modalContent">
              <span id="closeModal" style="float: right; cursor: pointer;">&times;</span>
              <h2>Add a new Task</h2>
              <form id="taskForm" method="post" data-url="{% url 'add_task' %}">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit">Save Task</button>
            </form>

          </div>
      </div>


      </div>
      </div>
  </body>
</html>
